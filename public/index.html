<!DOCTYPE html>
<html>
<head>
  <title>YouTube Video Downloader</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
  <form id="downloadForm">
    <input type="text" id="url" placeholder="Enter YouTube video URL" required>
    <input type="text" id="starttime" placeholder="Enter start time" required>
    <input type="text" id="endtime" placeholder="Enter end time" required>
    <button type="submit">Download</button>
  </form>

  <script>
        document.getElementById('downloadForm').addEventListener('submit', function(event) {
      event.preventDefault();
      console.log("Downloading");
      var url = document.getElementById('url').value;
      var starttime = document.getElementById('starttime').value;
      var endtime = document.getElementById('endtime').value;
      // Use Fetch API to initiate download without navigating away
      fetch(`/download?url=${encodeURIComponent(url)}&starttime=${encodeURIComponent(starttime)}&endtime=${encodeURIComponent(endtime)}`, {
        method: 'GET'
      })
      .then(response => {
        if (response.ok) {
          return response.blob();
        }
        throw new Error('Network response was not ok.');
      })
      .then(blob => {
        // Create a link and set the URL as the blob URL
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = url;
        // Set the download name
        a.download = 'downloaded_video.mp4';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
      })
      .catch(error => console.error('Error:', error));
    });
  </script>
</body>
</html>